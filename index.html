<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pinky-Math Domino</title>
    <link rel="stylesheet" href="css/style.css?v=domino-library-14">
</head>
<body>
    <div class="game-container">
        <!-- Start Screen -->
        <div class="screen" id="start-screen">
            <h1>Pinky-Math Domino</h1>
            <p class="subtitle">Game: Find the Double!</p>

            <div class="setup-panel">
                <div class="setup-columns">
                    <div class="setup-left">
                        <h3>Choose your game:</h3>
                        <div class="game-level-select">
                    <div class="level-btn-wrapper">
                        <button class="level-btn selected" data-level="circle" title="Sunny Level">
                            <svg viewBox="0 0 100 100" width="50" height="50">
                                <!-- Triangle rays pointing outward -->
                                <polygon points="50,3 42,22 58,22" fill="#FFA500"/>
                                <polygon points="50,97 42,78 58,78" fill="#FFA500"/>
                                <polygon points="3,50 22,42 22,58" fill="#FFA500"/>
                                <polygon points="97,50 78,42 78,58" fill="#FFA500"/>
                                <polygon points="14,14 30,22 22,30" fill="#FFA500"/>
                                <polygon points="86,86 70,78 78,70" fill="#FFA500"/>
                                <polygon points="86,14 78,30 70,22" fill="#FFA500"/>
                                <polygon points="14,86 22,70 30,78" fill="#FFA500"/>
                                <!-- Sun face -->
                                <circle cx="50" cy="50" r="28" fill="#FFD700"/>
                                <circle cx="50" cy="50" r="28" fill="none" stroke="#FFA500" stroke-width="2"/>
                                <!-- Rosy cheeks -->
                                <circle cx="32" cy="55" r="5" fill="#FF9999" opacity="0.6"/>
                                <circle cx="68" cy="55" r="5" fill="#FF9999" opacity="0.6"/>
                                <!-- Big cute eyes -->
                                <circle cx="40" cy="46" r="8" fill="white" stroke="#333" stroke-width="1"/>
                                <circle cx="60" cy="46" r="8" fill="white" stroke="#333" stroke-width="1"/>
                                <!-- Pupils -->
                                <circle cx="42" cy="47" r="4" fill="#333"/>
                                <circle cx="62" cy="47" r="4" fill="#333"/>
                                <!-- Eye highlights -->
                                <circle cx="38" cy="44" r="2" fill="white"/>
                                <circle cx="58" cy="44" r="2" fill="white"/>
                                <!-- Small mouth with lips -->
                                <ellipse cx="50" cy="62" rx="6" ry="4" fill="#FF6B6B"/>
                                <path d="M44 62 Q50 66 56 62" stroke="#CC4444" stroke-width="1" fill="none"/>
                            </svg>
                        </button>
                        <span class="level-label">2 dominos</span>
                    </div>
                    <div class="level-btn-wrapper">
                        <button class="level-btn" data-level="triangle" title="Alien Level">
                            <svg viewBox="0 0 100 100" width="50" height="50">
                                <!-- Alien body (triangle) -->
                                <polygon points="50,8 92,75 8,75" fill="#7CFC00" stroke="#32CD32" stroke-width="3"/>
                                <!-- Three eyes -->
                                <circle cx="50" cy="35" r="6" fill="white" stroke="#333" stroke-width="1"/>
                                <circle cx="50" cy="35" r="3" fill="#333"/>
                                <circle cx="35" cy="55" r="5" fill="white" stroke="#333" stroke-width="1"/>
                                <circle cx="35" cy="55" r="2.5" fill="#333"/>
                                <circle cx="65" cy="55" r="5" fill="white" stroke="#333" stroke-width="1"/>
                                <circle cx="65" cy="55" r="2.5" fill="#333"/>
                                <!-- Legs -->
                                <line x1="30" y1="75" x2="25" y2="95" stroke="#32CD32" stroke-width="5" stroke-linecap="round"/>
                                <line x1="70" y1="75" x2="75" y2="95" stroke="#32CD32" stroke-width="5" stroke-linecap="round"/>
                                <!-- Feet -->
                                <ellipse cx="25" cy="96" rx="6" ry="3" fill="#32CD32"/>
                                <ellipse cx="75" cy="96" rx="6" ry="3" fill="#32CD32"/>
                            </svg>
                        </button>
                        <span class="level-label">3 dominos</span>
                    </div>
                    <div class="level-btn-wrapper">
                        <button class="level-btn" data-level="star" title="Sunflower Level">
                            <svg viewBox="0 0 100 100" width="50" height="50">
                                <!-- Petals -->
                                <ellipse cx="50" cy="20" rx="10" ry="18" fill="#FFD700"/>
                                <ellipse cx="50" cy="80" rx="10" ry="18" fill="#FFD700"/>
                                <ellipse cx="20" cy="50" rx="18" ry="10" fill="#FFD700"/>
                                <ellipse cx="80" cy="50" rx="18" ry="10" fill="#FFD700"/>
                                <ellipse cx="28" cy="28" rx="10" ry="16" fill="#FFD700" transform="rotate(-45 28 28)"/>
                                <ellipse cx="72" cy="28" rx="10" ry="16" fill="#FFD700" transform="rotate(45 72 28)"/>
                                <ellipse cx="28" cy="72" rx="10" ry="16" fill="#FFD700" transform="rotate(45 28 72)"/>
                                <ellipse cx="72" cy="72" rx="10" ry="16" fill="#FFD700" transform="rotate(-45 72 72)"/>
                                <!-- Center -->
                                <circle cx="50" cy="50" r="18" fill="#8B4513"/>
                                <circle cx="50" cy="50" r="18" fill="none" stroke="#654321" stroke-width="2"/>
                                <!-- Seeds pattern -->
                                <circle cx="45" cy="45" r="2" fill="#333"/>
                                <circle cx="55" cy="45" r="2" fill="#333"/>
                                <circle cx="50" cy="52" r="2" fill="#333"/>
                                <circle cx="43" cy="55" r="2" fill="#333"/>
                                <circle cx="57" cy="55" r="2" fill="#333"/>
                            </svg>
                        </button>
                        <span class="level-label">4 dominos</span>
                    </div>
                </div>
                    </div>

                    <div class="setup-right">
                        <h3>Choose domino style:</h3>
                        <div class="domino-style-select">
                            <svg viewBox="0 0 50 100" width="50" height="100" class="domino-preview">
                                <rect x="1" y="1" width="48" height="98" rx="6" fill="#f0e0d0" stroke="#999" stroke-width="1.5"/>
                                <line x1="1" y1="50" x2="49" y2="50" stroke="#999" stroke-width="1"/>
                                <circle cx="25" cy="25" r="5" fill="#333"/>
                                <circle cx="25" cy="75" r="5" fill="#333"/>
                            </svg>
                            <svg viewBox="0 0 50 100" width="50" height="100" class="domino-preview">
                                <rect x="1" y="1" width="48" height="98" rx="6" fill="#f0e0d0" stroke="#999" stroke-width="1.5"/>
                                <line x1="1" y1="50" x2="49" y2="50" stroke="#999" stroke-width="1"/>
                                <circle cx="15" cy="20" r="5" fill="#333"/>
                                <circle cx="35" cy="30" r="5" fill="#333"/>
                                <circle cx="15" cy="70" r="5" fill="#333"/>
                                <circle cx="35" cy="70" r="5" fill="#333"/>
                                <circle cx="25" cy="80" r="5" fill="#333"/>
                            </svg>
                            <svg viewBox="0 0 50 100" width="50" height="100" class="domino-preview">
                                <rect x="1" y="1" width="48" height="98" rx="6" fill="#d0e0f0" stroke="#999" stroke-width="1.5"/>
                                <line x1="1" y1="50" x2="49" y2="50" stroke="#999" stroke-width="1"/>
                                <text x="25" y="32" text-anchor="middle" font-size="24" font-weight="bold" fill="#336">A</text>
                                <text x="25" y="82" text-anchor="middle" font-size="24" font-weight="bold" fill="#336">A</text>
                            </svg>
                            <svg viewBox="0 0 50 100" width="50" height="100" class="domino-preview">
                                <rect x="1" y="1" width="48" height="98" rx="6" fill="#e0f0d0" stroke="#999" stroke-width="1.5"/>
                                <line x1="1" y1="50" x2="49" y2="50" stroke="#999" stroke-width="1"/>
                                <text x="25" y="32" text-anchor="middle" font-size="22" fill="#363">3+2</text>
                                <text x="25" y="82" text-anchor="middle" font-size="22" fill="#363">3+2</text>
                            </svg>
                        </div>
                    </div>
                </div>

                <h3>How many players?</h3>
                <div class="player-select">
                    <button class="player-btn" data-players="1" data-xeno="true">1 Player + Xeno ‚è≥</button>
                    <button class="player-btn" data-players="2" data-xeno="false">2 Players</button>
                    <button class="player-btn" data-players="2" data-xeno="true">2 Players + Xeno ‚è≥</button>
                </div>

                <!-- Xeno Icon SVG -->
                <svg id="xeno-icon" style="display:none" viewBox="0 0 100 100">
                    <defs>
                        <linearGradient id="xenoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#FF69B4"/>
                            <stop offset="100%" style="stop-color:#FF1493"/>
                        </linearGradient>
                    </defs>
                    <!-- Body -->
                    <ellipse cx="50" cy="45" rx="20" ry="25" fill="url(#xenoGradient)"/>
                    <!-- Head -->
                    <ellipse cx="50" cy="18" rx="15" ry="12" fill="url(#xenoGradient)"/>
                    <!-- Eyes -->
                    <ellipse cx="44" cy="16" rx="5" ry="6" fill="white"/>
                    <ellipse cx="56" cy="16" rx="5" ry="6" fill="white"/>
                    <circle cx="44" cy="16" r="2.5" fill="black"/>
                    <circle cx="56" cy="16" r="2.5" fill="black"/>
                    <!-- Antennae -->
                    <line x1="42" y1="8" x2="35" y2="0" stroke="#FF69B4" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="35" cy="0" r="3" fill="#FF1493"/>
                    <line x1="58" y1="8" x2="65" y2="0" stroke="#FF69B4" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="65" cy="0" r="3" fill="#FF1493"/>
                    <!-- Upper Arms (pair 1) -->
                    <path d="M30 35 Q15 30 10 40" stroke="url(#xenoGradient)" stroke-width="5" fill="none" stroke-linecap="round"/>
                    <path d="M70 35 Q85 30 90 40" stroke="url(#xenoGradient)" stroke-width="5" fill="none" stroke-linecap="round"/>
                    <!-- Lower Arms (pair 2) -->
                    <path d="M32 50 Q15 55 8 50" stroke="url(#xenoGradient)" stroke-width="5" fill="none" stroke-linecap="round"/>
                    <path d="M68 50 Q85 55 92 50" stroke="url(#xenoGradient)" stroke-width="5" fill="none" stroke-linecap="round"/>
                    <!-- Tail -->
                    <path d="M50 70 Q55 80 45 90 Q40 95 50 98" stroke="url(#xenoGradient)" stroke-width="6" fill="none" stroke-linecap="round"/>
                    <!-- Smile -->
                    <path d="M43 22 Q50 28 57 22" stroke="#FF1493" stroke-width="2" fill="none" stroke-linecap="round"/>
                </svg>

                <div class="player-names" id="player-names" style="display: none;">
                    <button class="back-arrow-btn" id="back-to-setup-btn" title="Go back"><svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M13 16L7 10L13 4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
                    <h3>Enter player names:</h3>
                    <div id="name-inputs"></div>
                    <button class="btn btn-primary" id="start-game-btn">Start Game</button>
                </div>
            </div>
        </div>

        <!-- Domino Library Preview Screen (temporary) -->
        <div class="screen" id="domino-library-screen" style="display: none;">
            <button class="back-arrow-btn" id="back-from-library-btn" title="Go back to setup"><svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M13 16L7 10L13 4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
            <div class="library-zoom-fixed">
                <button class="zoom-btn" onclick="libraryZoomOut()" title="Zoom out">‚àí</button>
                <button class="zoom-btn" onclick="libraryZoomIn()" title="Zoom in">+</button>
                <button class="zoom-btn" onclick="toggleLibRuler()" title="Toggle ruler (Esc to hide)">‚ñ≠</button>
            </div>
            <div id="lib-ruler-rect" style="display:none;">
                <div class="ruler-handle ruler-tl"></div>
                <div class="ruler-handle ruler-tr"></div>
                <div class="ruler-handle ruler-bl"></div>
                <div class="ruler-handle ruler-br"></div>
                <div class="ruler-handle ruler-t"></div>
                <div class="ruler-handle ruler-r"></div>
                <div class="ruler-handle ruler-b"></div>
                <div class="ruler-handle ruler-l"></div>
            </div>
            <div class="domino-library-content">
                <h1 class="library-title">Domino Library ‚Äî Type 1, Set 1</h1>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">A1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="30" cy="30" r="6" fill="#333"/></svg></div><div class="library-desc">One dot (centered)</div></div>
                    <div class="library-card"><div class="library-label">A2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><line x1="30" y1="10.7" x2="30" y2="48.5" stroke="#333" stroke-width="4.5" stroke-linecap="butt"/><line x1="22.6" y1="48.5" x2="37.4" y2="48.5" stroke="#333" stroke-width="4.5" stroke-linecap="round"/><line x1="30" y1="10.7" x2="22.8" y2="18.8" stroke="#333" stroke-width="3.6" stroke-linecap="round"/></svg></div><div class="library-desc">Digit "1" with foot</div></div>
                    <div class="library-card"><div class="library-label">A3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="51" text-anchor="middle" font-size="59" font-family="Arial, sans-serif" font-weight="400" fill="#333">1</text></svg></div><div class="library-desc">Number "1"</div></div>
                    <div class="library-card"><div class="library-label">A4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="30" cy="30" r="5.4" fill="none" stroke="#333" stroke-width="2.5"/></svg></div><div class="library-desc">One hollow circle</div></div>
                    <div class="library-card"><div class="library-label">A5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="20" cy="20" r="6" fill="#333"/></svg></div><div class="library-desc">One dot (off-center)</div></div>
                </div>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">B1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="18" cy="30" r="6" fill="#333"/><circle cx="42" cy="30" r="6" fill="#333"/></svg></div><div class="library-desc">Two dots horizontal</div></div>
                    <div class="library-card"><div class="library-label">B2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="18" cy="18" r="6" fill="#333"/><circle cx="42" cy="42" r="6" fill="#333"/></svg></div><div class="library-desc">Two dots diagonal</div></div>
                    <div class="library-card"><div class="library-label">B3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="51" text-anchor="middle" font-size="59" font-family="Arial, sans-serif" font-weight="500" fill="#333" transform="translate(30,0) scale(0.85,1) translate(-30,0)">2</text></svg></div><div class="library-desc">Number "2"</div></div>
                    <div class="library-card"><div class="library-label">B4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><g transform="translate(15.4,8.75) scale(0.0917,0.08203)"><path d="M78.13,128.74c13.72.73,6.59-11.4,17.58-14.41,11.01-3.01,19.58,17.68,18.87,28.83-.71,11.15-11.09,22.03-14.75,24.37-13.56,8.68-52.97,14.43-70.24-11.01-5.69-8.37-8.94-18.09-11.59-27.8-5.3-19.45-2.71-47.27,5.23-65.84,5.74-13.41,13.8-28.45,25.87-36.93,10.75-7.55,10.62-7.49,22.88-12.41,68.73-27.61,122.74-11.03,162.64,31.8,5.08,5.45,9.14,10.23,12.43,14.68,1.64,2.22,3.08,4.37,4.36,6.47,9.2,16.81,12.63,36.22,12.43,55.45-.03,2.75-.13,5.49-.3,8.22.3,29.82-9.2,58.18-22.57,83.7-1.01,2.84-1.97,5.74-2.89,8.67-5.02,15.94-43.14,75.06-51.99,87.79-12.03,17.3-16.9,25.5-26,37.54-3.04,4.01-6.54,8.45-10.9,13.8-15.69,17.95-29.29,38.74-48.32,53.78-4.17,3.14-9.18,6.46-15.75,10.4,4.84-4.02,9.91-7.33,15.19-10,15.33-8.79,33.76-10.27,50.82-7.89,5.85.75,11.76,1.99,17.67,3.66,5.9,1.67,11.79,3.78,17.6,6.28,8.65,3.71,16.57,8.85,24.5,13.87,13.46,8.51,29.76,21.01,46.04,25.81,2.33.69,4.65,1.21,6.96,1.55,16.05,4.04,28.74-9.23,43.83-10.74,8.38-.75,13.31,7.67,9.9,14.33-5.99,12.49-14.48,24.12-25.71,33.36-1.96,1.64-3.97,3.23-6.02,4.79-2.04,1.55-4.11,3.07-6.2,4.57-2.35,2.42-4.79,4.46-7.3,6.14-22.62,15.14-51.1,1.49-67.62-19.41-1.88-1.54-3.73-3.03-5.53-4.46-3.6-2.84-6.99-5.41-9.99-7.37-13.06-8.53-29.31-12.27-44.88-10.33-29.88,3.72-66.69,30.89-79.81,37.01-3.74,1.74-34.53,10.19-40.84,10.16-12.4-.06-17.05-5.33-19.62-8.69-4.09-5.35-6.3-23.51-.87-34.31,4.64-9.24,8.96-17.34,13.11-24.69,2.07-3.68,4.11-7.17,6.11-10.52,22.94-38.5,45.94-76.76,74.57-111.63,2.64-3.54,5.28-7.08,7.92-10.61,7.92-10.61,15.79-21.24,23.33-32.06,2.67-3.78,5.35-7.55,8.04-11.32,13.42-18.85,26.88-37.7,39.38-57.13,2.29-3.93,4.51-7.9,6.68-11.88,4.33-7.98,8.46-16.05,12.34-24.24,1.72-4.3,3.33-8.65,4.8-13.07.75-2.73,1.41-5.47,1.98-8.22,1.72-8.25,2.66-16.64,2.56-25.09-.14-2.87-.42-5.72-.8-8.54-1.55-11.29-4.89-22.21-10.32-31.93-1.9-2.55-4-5.13-6.29-7.71-2.29-2.59-4.79-5.19-7.5-7.8-7.31-7.05-23.19-13.4-32.51-16.6-25.89-8.87-60.56-2.13-76.52,17.8-6.87,8.58-9.79,21.02-9.31,31.91.48,10.9,6.19,17.85,17.33,17.89" fill="#333" stroke="#f5e6c8" stroke-width="2"/></g></svg></div><div class="library-desc">Handwritten "2"</div></div>
                    <div class="library-card"><div class="library-label">B5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="30" cy="18" r="5.4" fill="none" stroke="#333" stroke-width="2.5"/><circle cx="30" cy="42" r="5.4" fill="none" stroke="#333" stroke-width="2.5"/></svg></div><div class="library-desc">Hollow dots vertical</div></div>
                </div>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">C1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"></svg></div><div class="library-desc">Empty</div></div>
                    <div class="library-card"><div class="library-label">C2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"></svg></div><div class="library-desc">Empty</div></div>
                    <div class="library-card"><div class="library-label">C3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"></svg></div><div class="library-desc">Empty</div></div>
                    <div class="library-card"><div class="library-label">C4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="51" text-anchor="middle" font-size="59" font-family="Arial, sans-serif" font-weight="400" fill="#333" transform="translate(0,30) scale(1,0.98) translate(0,-30)">0</text></svg></div><div class="library-desc">Number "0"</div></div>
                    <div class="library-card"><div class="library-label">C5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="50" text-anchor="middle" font-size="59" font-family="'Times New Roman', serif" font-weight="400" fill="#333" transform="translate(0,30) scale(1,1.034) translate(0,-30)">0</text></svg></div><div class="library-desc">Number "0" (serif)</div></div>
                </div>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">D1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="51" text-anchor="middle" font-size="59" font-family="Arial, sans-serif" font-weight="400" fill="#333" transform="translate(0,30) scale(1,0.98307) translate(0,-30)">3</text></svg></div><div class="library-desc">Number "3"</div></div>
                    <div class="library-card"><div class="library-label">D2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><path d="M22,12 L38,12 C46,12 43,28.2 25,28.2 C48,28.2 48,53.4 18,46.2" fill="none" stroke="#333" stroke-width="4.5" stroke-linecap="round" stroke-linejoin="round" transform="translate(0,30) scale(1,1.0813) translate(0,-30)"/></svg></div><div class="library-desc">"3" (flat top)</div></div>
                    <div class="library-card"><div class="library-label">D3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="15" cy="11" r="6" fill="#333"/><circle cx="30" cy="27" r="6" fill="#333"/><circle cx="45" cy="43" r="6" fill="#333"/></svg></div><div class="library-desc">3 dots diagonal</div></div>
                    <div class="library-card"><div class="library-label">D4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="30" cy="16" r="6" fill="#333"/><circle cx="17" cy="42" r="6" fill="#333"/><circle cx="43" cy="42" r="6" fill="#333"/></svg></div><div class="library-desc">3 dots triangle</div></div>
                    <div class="library-card"><div class="library-label">D5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="16" cy="16" r="6" fill="#333"/><circle cx="32" cy="16" r="6" fill="#333"/><circle cx="44" cy="44" r="6" fill="#333"/></svg></div><div class="library-desc">2 close + 1 far</div></div>
                </div>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">E1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><g transform="translate(0,30) scale(1,0.9506) translate(0,-30)"><path d="M36,9 L36,51" stroke="#333" stroke-width="4.5" stroke-linecap="round" fill="none"/><path d="M16,9 L16,35.7" stroke="#333" stroke-width="4.5" stroke-linecap="round" fill="none"/><path d="M16,35.7 L42,35.7" stroke="#333" stroke-width="4.5" stroke-linecap="round" fill="none"/></g></svg></div><div class="library-desc">"4" (open top)</div></div>
                    <div class="library-card"><div class="library-label">E2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><g transform="translate(0,30) scale(1,0.9506) translate(0,-30)"><path d="M34,9 L34,51" stroke="#333" stroke-width="4.5" stroke-linecap="round" fill="none"/><path d="M34,9 L14,35.7 L40.6,35.7" stroke="#333" stroke-width="4.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/></g></svg></div><div class="library-desc">"4" (original)</div></div>
                    <div class="library-card"><div class="library-label">E3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="13" cy="13" r="6" fill="#333"/><circle cx="29" cy="13" r="6" fill="#333"/><circle cx="21" cy="27" r="6" fill="#333"/><circle cx="46" cy="46" r="6" fill="#333"/></svg></div><div class="library-desc">3 grouped + 1</div></div>
                    <div class="library-card"><div class="library-label">E4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="17" cy="17" r="6" fill="#333"/><circle cx="43" cy="17" r="6" fill="#333"/><circle cx="17" cy="43" r="6" fill="#333"/><circle cx="43" cy="43" r="6" fill="#333"/></svg></div><div class="library-desc">4 dots corners</div></div>
                    <div class="library-card"><div class="library-label">E5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="12" cy="14" r="6" fill="#333"/><circle cx="28" cy="14" r="6" fill="#333"/><circle cx="32" cy="46" r="6" fill="#333"/><circle cx="48" cy="46" r="6" fill="#333"/></svg></div><div class="library-desc">2 pairs (TL+BR)</div></div>
                </div>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">F1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="51" text-anchor="middle" font-size="59" font-family="Arial, sans-serif" font-weight="500" fill="#333" transform="translate(30,0) scale(0.85,1) translate(-30,0)">5</text></svg></div><div class="library-desc">Number "5"</div></div>
                    <div class="library-card"><div class="library-label">F2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="15" cy="15" r="6" fill="#333"/><circle cx="45" cy="15" r="6" fill="#333"/><circle cx="30" cy="30" r="6" fill="#333"/><circle cx="15" cy="45" r="6" fill="#333"/><circle cx="45" cy="45" r="6" fill="#333"/></svg></div><div class="library-desc">5 dots (corners+center)</div></div>
                    <div class="library-card"><div class="library-label">F3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="13" cy="13" r="6" fill="#333"/><circle cx="29" cy="13" r="6" fill="#333"/><circle cx="21" cy="27" r="6" fill="#333"/><circle cx="35" cy="48" r="6" fill="#333"/><circle cx="51" cy="48" r="6" fill="#333"/></svg></div><div class="library-desc">3 triangle + 2 pair</div></div>
                    <div class="library-card"><div class="library-label">F4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="14" cy="14" r="6" fill="#333"/><circle cx="30" cy="14" r="6" fill="#333"/><circle cx="14" cy="30" r="6" fill="#333"/><circle cx="30" cy="30" r="6" fill="#333"/><circle cx="48" cy="48" r="6" fill="#333"/></svg></div><div class="library-desc">4 group + 1 aside</div></div>
                    <div class="library-card"><div class="library-label">F5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="22" cy="14" r="6" fill="#333"/><circle cx="38" cy="14" r="6" fill="#333"/><circle cx="15" cy="48" r="6" fill="#333"/><circle cx="31" cy="48" r="6" fill="#333"/><circle cx="47" cy="48" r="6" fill="#333"/></svg></div><div class="library-desc">3 bottom + 2 vertical</div></div>
                </div>

                <div class="library-section"></div>
                <div class="library-row">
                    <div class="library-card"><div class="library-label">G1</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><text x="30" y="51" text-anchor="middle" font-size="59" font-family="Arial, sans-serif" font-weight="500" fill="#333" transform="translate(30,30) scale(0.85,0.98505) translate(-30,-30)">6</text></svg></div><div class="library-desc">Number "6"</div></div>
                    <div class="library-card"><div class="library-label">G2</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="10" cy="10" r="6" fill="#333"/><circle cx="26" cy="10" r="6" fill="#333"/><circle cx="19" cy="23" r="6" fill="#333"/><circle cx="35" cy="37" r="6" fill="#333"/><circle cx="51" cy="37" r="6" fill="#333"/><circle cx="43" cy="50" r="6" fill="#333"/></svg></div><div class="library-desc">2 groups of 3</div></div>
                    <div class="library-card"><div class="library-label">G3</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="13" cy="30" r="6" fill="#333"/><circle cx="33" cy="30" r="6" fill="#333"/><circle cx="23" cy="39" r="6" fill="#333"/><circle cx="13" cy="48" r="6" fill="#333"/><circle cx="33" cy="48" r="6" fill="#333"/><circle cx="50" cy="12" r="6" fill="#333"/></svg></div><div class="library-desc">5 close + 1 separate</div></div>
                    <div class="library-card"><div class="library-label">G4</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="13" cy="12" r="6" fill="#333"/><circle cx="29" cy="12" r="6" fill="#333"/><circle cx="13" cy="28" r="6" fill="#333"/><circle cx="29" cy="28" r="6" fill="#333"/><circle cx="38" cy="46" r="6" fill="#333"/><circle cx="52" cy="46" r="6" fill="#333"/></svg></div><div class="library-desc">4 group + 2 aside</div></div>
                    <div class="library-card"><div class="library-label">G5</div><div class="domino-half-preview"><svg viewBox="0 0 60 60"><circle cx="16" cy="12" r="6" fill="#333"/><circle cx="16" cy="30" r="6" fill="#333"/><circle cx="16" cy="48" r="6" fill="#333"/><circle cx="44" cy="12" r="6" fill="#333"/><circle cx="44" cy="30" r="6" fill="#333"/><circle cx="44" cy="48" r="6" fill="#333"/></svg></div><div class="library-desc">2 vertical groups of 3</div></div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="screen" id="game-screen" style="display: none;">
            <!-- Back arrow button -->
            <button class="back-arrow-btn" id="back-arrow-btn" title="Go back to setup"><svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M13 16L7 10L13 4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
            <header>
                <h1>Pinky-Math Domino</h1>
                <div class="turn-indicator">
                    <span id="current-player-name">Player 1</span>'s turn
                </div>
            </header>

            <!-- Status Message -->
            <div class="status" id="status-message">Select the highest double to start!</div>

            <main>
                <!-- Game Board -->
                <div class="board-container">
                    <div class="board" id="game-board">
                        <div class="board-placeholder">Waiting for highest double...</div>
                    </div>
                    <!-- Celebration area -->
                    <div class="celebration-area" id="celebration-area" style="display: none;">
                        <div class="celebration-emoji">üéâ</div>
                    </div>
                </div>

                <!-- All Players' Hands (open game) -->
                <div class="players-area" id="players-area">
                    <!-- Player hands will be generated here -->
                </div>

                <!-- Xeno Timer Box (for Sun Level) -->
                <div class="xeno-timer-box" id="xeno-timer-box" style="display: none;">
                    <div class="xeno-timer-header">
                        <span class="xeno-timer-icon" id="xeno-timer-icon"></span>
                        <span class="xeno-timer-name">Xeno's Timer</span>
                    </div>
                    <div class="xeno-timer-content">
                        <svg viewBox="0 0 120 120" class="timer-svg">
                            <!-- Background circle -->
                            <circle cx="60" cy="60" r="50" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="8"/>
                            <!-- Progress circle (countdown) -->
                            <circle cx="60" cy="60" r="50" fill="none" stroke="#4CAF50" stroke-width="8"
                                    stroke-dasharray="314" stroke-dashoffset="0"
                                    transform="rotate(-90 60 60)" class="timer-progress"/>
                            <!-- Tick marks -->
                            <g class="timer-ticks" id="timer-ticks"></g>
                        </svg>
                        <div class="timer-display" id="timer-display">5</div>
                    </div>
                </div>

                <!-- Bank -->
                <div class="bank-area">
                    <div class="bank" id="bank">
                        <div class="bank-icon-wrapper">
                            <span class="bank-icon">üèõÔ∏è</span>
                            <span class="bank-dollar-overlay">$</span>
                        </div>
                        <div class="bank-info">
                            <span id="bank-count">0</span> dominos
                        </div>
                    </div>
                    <button class="btn btn-draw" id="draw-btn" disabled>
                        Draw from Bank
                    </button>
                </div>
            </main>

            <!-- Game Controls -->
            <div class="controls">
                <button class="btn btn-secondary" id="pass-btn" disabled>Skip Turn</button>
                <button class="btn btn-primary" id="play-again-game-btn" style="display: none;">Play Again</button>
                <button class="btn btn-secondary" id="new-game-btn">New Game</button>
            </div>
        </div>

        <!-- Winner Modal -->
        <div class="modal" id="winner-modal">
            <div class="modal-content">
                <div id="single-winner-content">
                    <h2 id="winner-heading">üéâ Winner! üéâ</h2>
                    <p id="winner-name">Player 1 wins!</p>
                    <p id="winner-says" class="winner-speech">"I Won!"</p>
                </div>
                <div id="circle-winners-content" style="display: none;">
                    <h2>üéâ Circle of Winners! üéâ</h2>
                    <p id="winners-names">Players win together!</p>
                    <div class="we-won-animation" id="we-won-animation">
                        <span class="we-won-text">"We Won!"</span>
                    </div>
                </div>
                <button class="btn btn-primary" id="play-again-btn">Play Again</button>
            </div>
        </div>

        <!-- Winner Celebration Container (for sparkles) -->
        <div class="winner-celebration" id="winner-celebration"></div>

        <!-- Winner Banner (shows when someone wins) -->
        <div class="winner-banner" id="winner-banner" style="display: none;">
            <h2>Here is the <span id="winner-ordinal">first</span> winner!</h2>
            <div class="winner-name" id="banner-winner-name">Player Name</div>
        </div>
    </div>

    <script>
        // Ruler rectangle: toggle, drag from center, resize from corners
        function toggleLibRuler() {
            const r = document.getElementById('lib-ruler-rect');
            r.style.display = r.style.display === 'none' ? 'block' : 'none';
        }
        (function() {
            const r = document.getElementById('lib-ruler-rect');
            let mode = null, sx, sy, sL, sT, sW, sH, sRatio;
            r.addEventListener('mousedown', function(e) {
                const cls = e.target.className;
                if (cls.includes('ruler-tl')) mode = 'tl';
                else if (cls.includes('ruler-tr')) mode = 'tr';
                else if (cls.includes('ruler-bl')) mode = 'bl';
                else if (cls.includes('ruler-br')) mode = 'br';
                else if (cls.includes('ruler-t')) mode = 't';
                else if (cls.includes('ruler-r')) mode = 'r';
                else if (cls.includes('ruler-b')) mode = 'b';
                else if (cls.includes('ruler-l')) mode = 'l';
                else mode = 'drag';
                sx = e.clientX; sy = e.clientY;
                sL = r.offsetLeft; sT = r.offsetTop;
                sW = r.offsetWidth; sH = r.offsetHeight;
                sRatio = sW / sH;
                e.preventDefault();
            });
            document.addEventListener('mousemove', function(e) {
                if (!mode) return;
                const dx = e.clientX - sx, dy = e.clientY - sy;
                if (mode === 'drag') {
                    r.style.left = (sL + dx) + 'px';
                    r.style.top = (sT + dy) + 'px';
                } else if (mode === 'br') {
                    const nw = Math.max(20, sW + dx);
                    r.style.width = nw + 'px';
                    r.style.height = (nw / sRatio) + 'px';
                } else if (mode === 'bl') {
                    const nw = Math.max(20, sW - dx);
                    r.style.width = nw + 'px';
                    r.style.left = (sL + sW - nw) + 'px';
                    r.style.height = (nw / sRatio) + 'px';
                } else if (mode === 'tr') {
                    const nw = Math.max(20, sW + dx);
                    const nh = nw / sRatio;
                    r.style.width = nw + 'px';
                    r.style.height = nh + 'px';
                    r.style.top = (sT + sH - nh) + 'px';
                } else if (mode === 'tl') {
                    const nw = Math.max(20, sW - dx);
                    const nh = nw / sRatio;
                    r.style.width = nw + 'px';
                    r.style.left = (sL + sW - nw) + 'px';
                    r.style.height = nh + 'px';
                    r.style.top = (sT + sH - nh) + 'px';
                } else if (mode === 't') {
                    const nh = Math.max(20, sH - dy);
                    r.style.height = nh + 'px';
                    r.style.top = (sT + sH - nh) + 'px';
                } else if (mode === 'b') {
                    r.style.height = Math.max(20, sH + dy) + 'px';
                } else if (mode === 'l') {
                    const nw = Math.max(20, sW - dx);
                    r.style.width = nw + 'px';
                    r.style.left = (sL + sW - nw) + 'px';
                } else if (mode === 'r') {
                    r.style.width = Math.max(20, sW + dx) + 'px';
                }
            });
            document.addEventListener('mouseup', function() { mode = null; });
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') r.style.display = 'none';
            });
        })();

        let libZoom = 1;
        function libraryZoomIn() {
            libZoom = Math.min(3, libZoom + 0.25);
            applyLibZoom();
        }
        function libraryZoomOut() {
            libZoom = Math.max(0.5, libZoom - 0.25);
            applyLibZoom();
        }
        function applyLibZoom() {
            const cardSize = Math.round(70 * libZoom);
            const svgSize = Math.round(60 * libZoom);
            document.querySelectorAll('.domino-half-preview').forEach(el => {
                el.style.width = cardSize + 'px';
                el.style.height = cardSize + 'px';
            });
            document.querySelectorAll('.domino-half-preview svg').forEach(el => {
                el.style.width = svgSize + 'px';
                el.style.height = svgSize + 'px';
            });
        }
    </script>
    <script src="js/domino.js?v=xeno-fix-3"></script>
    <script src="js/game.js?v=domino-library-1"></script>
</body>
</html>
